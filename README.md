# 🌡️ 기상청 온도 데이터 다운로드 시스템

기상청 Open API를 활용하여 서울시 금천구의 기온 및 습도 데이터를 15분 단위로 다운로드하는 웹 애플리케이션입니다.

## ✨ 주요 기능

- 📅 **간편한 날짜 선택**: 원하는 날짜를 선택하여 해당일의 하루치 데이터 다운로드
- ⏱️ **15분 단위 데이터**: 하루 96개의 데이터 포인트 (00:00, 00:15, 00:30, 00:45 ...)
- 📊 **CSV 형식**: Excel이나 Google Sheets에서 바로 사용 가능
- 🌡️ **다양한 기상 정보**: 기온, 습도, 풍향, 풍속, 기압, 이슬점온도 등
- 📍 **지점별 조회**: 금천구(417) 기준, 다른 지점도 테스트 가능

## 🚀 시작하기

### 필요 조건

- Node.js (v14 이상)
- npm 또는 yarn
- 기상청 API 인증키 ([기상청 API 허브](https://apihub.kma.go.kr/)에서 발급)

### 설치 방법

1. **저장소 클론 또는 다운로드**

2. **의존성 설치**
```bash
npm install
```

3. **환경 변수 설정**

프로젝트 루트에 `.env` 파일을 생성하고 API 키를 입력합니다:

```env
KMA_API_KEY=your_api_key_here
PORT=3000
```

4. **서버 실행**
```bash
node server.js
```

5. **브라우저에서 접속**
```
http://localhost:3000
```

## 📖 사용 방법

### 기본 사용

1. 웹 페이지에 접속합니다
2. "온도 데이터를 얻을 날짜"에서 원하는 날짜를 선택합니다
3. "📥 데이터 다운로드" 버튼을 클릭합니다
4. CSV 파일이 자동으로 다운로드됩니다

### CSV 파일 구조

다운로드된 CSV 파일은 다음과 같은 구조를 가집니다:

```csv
id,temperature,humidity,recorded_at,location
1,14.8,66.2,2025-10-23 00:00:00,서울시 금천구
2,14.5,67.1,2025-10-23 00:15:00,서울시 금천구
3,14.3,68.0,2025-10-23 00:30:00,서울시 금천구
...
```

- **id**: 순번
- **temperature**: 기온 (°C)
- **humidity**: 습도 (%)
- **recorded_at**: 측정 시각
- **location**: 측정 지점

### 지점 테스트 기능

페이지 하단의 "🔧 지점 테스트 도구"를 사용하여:
- 다른 기상 관측 지점의 데이터 확인 가능
- 지점번호 입력 후 "🔍 지점 테스트" 클릭
- "📋 지점 목록 조회"로 사용 가능한 지점 확인 가능

## 🏗️ 프로젝트 구조

```
외기온도 기상청 API/
├── server.js              # Express 서버 및 API 처리
├── public/
│   ├── index.html        # 웹 UI
│   └── app.js            # 프론트엔드 로직
├── .env                  # 환경 변수 (직접 생성)
├── package.json          # 프로젝트 설정
└── README.md            # 프로젝트 문서
```

## 🔧 기술 스택

### Backend
- **Node.js**: 서버 런타임
- **Express**: 웹 프레임워크
- **Axios**: HTTP 클라이언트
- **dotenv**: 환경 변수 관리

### Frontend
- **Vanilla JavaScript**: 프론트엔드 로직
- **HTML5 & CSS3**: UI 구성
- **Fetch API**: 서버 통신

### API
- **기상청 Open API**: AWS 매분 자료 (`nph-aws2_min`)
- **데이터 포맷**: 텍스트 형식 (공백으로 구분)

## 📡 API 명세

### 기상청 AWS 매분 자료 API

**엔드포인트**: `https://apihub.kma.go.kr/api/typ01/cgi-bin/url/nph-aws2_min`

**파라미터**:
- `tm1`: 시작 시간 (YYYYMMDDHHmm)
- `tm2`: 종료 시간 (YYYYMMDDHHmm)
- `stn`: 지점번호 (417: 금천구)
- `disp`: 표출형태 (0: 고정폭)
- `help`: 도움말 (0: 데이터만, 1: 헤더 포함)
- `authKey`: API 인증키

**데이터 항목**:
- TA: 기온 (°C)
- HM: 습도 (%)
- TD: 이슬점온도 (°C)
- WD1, WDS, WD10: 풍향 (°)
- WS1, WSS, WS10: 풍속 (m/s)
- PA: 현지기압 (hPa)
- PS: 해면기압 (hPa)
- RN-15m, RN-60m, RN-12H, RN-DAY: 강수량 (mm)

## 🎯 주요 지점번호

| 지점번호 | 지점명 | 위치 |
|---------|--------|------|
| 108 | 서울 | 서울 송파구 |
| 417 | 금천구 | 서울 금천구 |
| 401 | 강남구 | 서울 강남구 |
| 119 | 수원 | 경기 수원시 |

> 더 많은 지점 정보는 웹 페이지의 "📋 지점 목록 조회" 버튼으로 확인하세요.

## 🔍 데이터 처리 과정

1. **사용자 입력**: 날짜 선택 (예: 2025-10-23)
2. **시간 변환**: 
   - 시작: 202510230000 (00:00)
   - 종료: 202510240000 (다음날 00:00)
3. **API 호출**: 기상청 서버에 데이터 요청
4. **데이터 파싱**: 텍스트 데이터를 구조화된 형태로 변환
5. **15분 필터링**: 00, 15, 30, 45분 데이터만 추출
6. **CSV 생성**: Excel 호환 CSV 파일 생성
7. **다운로드**: 브라우저를 통해 파일 다운로드

## ⚠️ 주의사항

- **API 키 보안**: `.env` 파일은 절대 공개 저장소에 올리지 마세요
- **데이터 범위**: 하루치 데이터(96개 포인트)만 조회 가능
- **호출 제한**: 기상청 API의 호출 제한을 준수하세요
- **데이터 지연**: 실시간 데이터는 약간의 지연이 있을 수 있습니다

## 🐛 문제 해결

### 데이터가 다운로드되지 않을 때

1. **API 키 확인**: `.env` 파일의 API 키가 올바른지 확인
2. **지점번호 확인**: 417번 지점이 유효한지 확인
3. **날짜 확인**: 너무 오래된 날짜나 미래 날짜는 데이터가 없을 수 있음
4. **브라우저 콘솔**: F12를 눌러 콘솔에서 에러 메시지 확인
5. **서버 터미널**: 서버 실행 터미널에서 에러 로그 확인

### 서버가 시작되지 않을 때

```bash
# 포트가 이미 사용 중인 경우
# .env 파일에서 PORT 번호 변경

# 의존성 재설치
rm -rf node_modules package-lock.json
npm install
```

## 📝 라이선스

이 프로젝트는 개인 학습 및 연구 목적으로 제작되었습니다.

## 🔗 참고 자료

- [기상청 API 허브](https://apihub.kma.go.kr/)
- [기상청 Open API 이용 안내](https://apihub.kma.go.kr/guide/)
- [AWS(자동기상관측장비) 데이터 설명](https://data.kma.go.kr/data/rmt/rmtList.do?code=400&pgmNo=570)

## 👤 개발자

질문이나 문의사항이 있으시면 이슈를 등록해주세요.

---

**Made with ❤️ using KMA Open API**
